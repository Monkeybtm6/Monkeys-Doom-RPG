ACTOR ShotgunWS : Shotgun replaces Shotgun
{
  Weapon.SelectionOrder 1300
  Weapon.AmmoUse 1
  Weapon.AmmoUse2 1
  Weapon.AmmoGive 0
  Weapon.AmmoGive2 8
  Weapon.AmmoType "SGMag"
  Weapon.AmmoType2 "Shell"
  Weapon.SlotNumber 3
  Weapon.KickBack 60
  Weapon.SelectionOrder 1300
  Inventory.PickupMessage "$GOTSHOTGUN"
  Obituary "$OB_MPSHOTGUN"
  DamageType "pierce"
  +Weapon.Ammo_Optional
  Tag "$TAG_SHOTGUN"
  States
  {
  Ready:
    SHTG A 1 A_WeaponReady(wrf_allowreload)
    Loop
  
  Deselect:
    SHTG A 1 A_Lower
    Loop
  
  Select:
    SHTG A 1 A_Raise
    Loop
  
  Fire:
    SHTG A 0 A_JumpIfnoammo("Reload")
    SHTF A 0 A_FireBullets (4.2, 3.8, 7, (ACS_NamedExecuteWithResult("DAMAGESCR",10,0,0)), "BulletPuff", FBF_USEAMMO|FBF_NORANDOM)
    SHTF A 0 A_PlaySound ("weapons/SGfire", CHAN_WEAPON)
    SHTF A 0 //A_GunFlash
    SHTF A 1 Radius_Quake(2,3,0,1,0)
	SHTF ABCDEF 2 Bright A_Light1
    SHTG BCDEFGHIIIIHGFEDCB 1
	SHTG A 7 A_ReFire
    Goto Ready
  
   Reload:
    PKPI A 0 A_JumpIfInventory ("SGMAG", 8, 2)
    PKPI A 0 A_JumpIfInventory("shell", 1, "ReloadStep")
    PKPI A 0
    goto ready
   Reloadstep:
    PKPR A 0
	PKPR BCDE 0
    PKPR F 0
   ReloadLoop:
    SHTR AAAABBCDE 1
    SHTR F 1 A_playsound("weapons/SGLOAD")
    TNT1 A 0 A_TakeInventory("shell", 1)
	TNT1 A 0 A_GiveInventory("SGMAG", 1)
	TNT1 A 0 A_JumpIfInventory("SGMAG", 8, "ReloadDone")
	SHTR EDDCCCDDE 1
	SHTR H 1 A_playsound("weapons/SGLOAD")
	TNT1 A 0 A_TakeInventory("shell", 1)
	TNT1 A 0 A_GiveInventory("SGMAG", 1)
	SHTR I 1
	TNT1 A 0 A_JumpIfInventory("SGMAG", 8, "ReloadDone")
    TNT1 A 0 A_JumpIfInventory("shell", 1, "ReloadLoop")
    SHTR FGHI 1
	Goto ReloadDone
   ReloadDone:
    SHER AB 1
	goto ready
  
  Flash:
    SHTF A 3 Bright A_Light1
    SHTF A 1 Radius_Quake(1,2,0,1,0)
	SHTF B 3 Bright A_Light2
    stop
  
  Spawn:
    SHOT A -1
    Stop
  }
}

ACTOR ShotPuff2
{
  +NOBLOCKMAP
  +NOGRAVITY
  +ALLOWPARTICLES
  +RANDOMIZE
  RenderStyle Translucent
  Alpha 0.5
  VSpeed 0
  Mass 0
  States
  {
  Spawn:
    BAL7 CDE 6 Bright
	stop
    // Intentional fall-through
  }
}

ACTOR AltShotPuff2
{
  +NOBLOCKMAP
  +NOGRAVITY
  +ALLOWPARTICLES
  +RANDOMIZE
  RenderStyle Translucent
  Alpha 0.5
  VSpeed 0
  Mass 0
  States
  {
  Spawn:
    OCPS DEFG 4 Bright
	stop
    // Intentional fall-through
  }
}

actor AltShotProj2
{
  height 8
  radius 6
  damage 12
  speed 90 
  renderstyle Add
  alpha 1
  seesound "misc/shot"
  deathsound "misc/shotx"
  PROJECTILE
  +RANDOMIZE
  states
  {
  Spawn:
    LTNB A 1 bright A_SpawnItemEx("AltShotTrail",2,3,0,0,0,0,0)
    LTNB B 1 bright A_SpawnItemEx("AltShotTrail",2,3,0,0,0,0,0)
	LTNB C 1 bright A_SpawnItemEx("AltShotTrail",3,2,0,0,0,0,0)
  Death:
    LTNB DEF 3 Bright
    stop
  }
}

actor AltShotTrail
{
  Renderstyle Add
  Alpha 0.75
  +NOGRAVITY
  states
  {
  Spawn:
    LTNB ABC 3 bright 
    //Loop
  Death:
    TNT1 A 0 Bright
    stop
  }
}

actor SGMAG : ammo
{
 Inventory.MaxAmount 8
 +IGNORESKILL
}